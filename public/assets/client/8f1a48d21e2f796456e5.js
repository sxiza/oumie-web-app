(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{234:function(t,e,r){"use strict";var n=r(29),s=r.n(n),a=r(30),i=r.n(a),o=function(){function t(){s()(this,t)}return i()(t,null,[{key:"getMessages",value:function(t){var e=t.response;switch(e.status){case this.CODE_VALIDATION:return e.data.errors;case this.CODE_UNAUTHORIZED:return e.data;default:return e.statusText}}},{key:"CODE_VALIDATION",get:function(){return 422}},{key:"CODE_UNAUTHORIZED",get:function(){return 400}}]),t}();e.a=o},242:function(t,e,r){"use strict";var n=r(3),s=r.n(n),a=r(4),i=r.n(a),o=r(29),c=r.n(o),u=r(30),l=r.n(u),p=r(234),f=function(){function t(e){c()(this,t),this.client=e,this.prefix="/beneficiary"}return l()(t,[{key:"show",value:function(){var t=i()(s.a.mark(function t(e){return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.client.get(this.prefix+"/".concat(e));case 3:return t.abrupt("return",t.sent.data);case 6:return t.prev=6,t.t0=t.catch(0),console.error(p.a.getMessages(t.t0)),t.abrupt("return",t.t0);case 10:case"end":return t.stop()}},t,this,[[0,6]])}));return function(e){return t.apply(this,arguments)}}()},{key:"getAll",value:function(){var t=i()(s.a.mark(function t(){return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.client.get(this.prefix);case 3:return t.abrupt("return",t.sent.data);case 6:return t.prev=6,t.t0=t.catch(0),console.error(p.a.getMessages(t.t0)),t.abrupt("return",t.t0);case 10:case"end":return t.stop()}},t,this,[[0,6]])}));return function(){return t.apply(this,arguments)}}()}]),t}();e.a=f},390:function(t,e,r){var n={"./af":247,"./af.js":247,"./ar":248,"./ar-dz":249,"./ar-dz.js":249,"./ar-kw":250,"./ar-kw.js":250,"./ar-ly":251,"./ar-ly.js":251,"./ar-ma":252,"./ar-ma.js":252,"./ar-sa":253,"./ar-sa.js":253,"./ar-tn":254,"./ar-tn.js":254,"./ar.js":248,"./az":255,"./az.js":255,"./be":256,"./be.js":256,"./bg":257,"./bg.js":257,"./bm":258,"./bm.js":258,"./bn":259,"./bn.js":259,"./bo":260,"./bo.js":260,"./br":261,"./br.js":261,"./bs":262,"./bs.js":262,"./ca":263,"./ca.js":263,"./cs":264,"./cs.js":264,"./cv":265,"./cv.js":265,"./cy":266,"./cy.js":266,"./da":267,"./da.js":267,"./de":268,"./de-at":269,"./de-at.js":269,"./de-ch":270,"./de-ch.js":270,"./de.js":268,"./dv":271,"./dv.js":271,"./el":272,"./el.js":272,"./en-au":273,"./en-au.js":273,"./en-ca":274,"./en-ca.js":274,"./en-gb":275,"./en-gb.js":275,"./en-ie":276,"./en-ie.js":276,"./en-il":277,"./en-il.js":277,"./en-nz":278,"./en-nz.js":278,"./eo":279,"./eo.js":279,"./es":280,"./es-do":281,"./es-do.js":281,"./es-us":282,"./es-us.js":282,"./es.js":280,"./et":283,"./et.js":283,"./eu":284,"./eu.js":284,"./fa":285,"./fa.js":285,"./fi":286,"./fi.js":286,"./fo":287,"./fo.js":287,"./fr":288,"./fr-ca":289,"./fr-ca.js":289,"./fr-ch":290,"./fr-ch.js":290,"./fr.js":288,"./fy":291,"./fy.js":291,"./gd":292,"./gd.js":292,"./gl":293,"./gl.js":293,"./gom-latn":294,"./gom-latn.js":294,"./gu":295,"./gu.js":295,"./he":296,"./he.js":296,"./hi":297,"./hi.js":297,"./hr":298,"./hr.js":298,"./hu":299,"./hu.js":299,"./hy-am":300,"./hy-am.js":300,"./id":301,"./id.js":301,"./is":302,"./is.js":302,"./it":303,"./it.js":303,"./ja":304,"./ja.js":304,"./jv":305,"./jv.js":305,"./ka":306,"./ka.js":306,"./kk":307,"./kk.js":307,"./km":308,"./km.js":308,"./kn":309,"./kn.js":309,"./ko":310,"./ko.js":310,"./ku":311,"./ku.js":311,"./ky":312,"./ky.js":312,"./lb":313,"./lb.js":313,"./lo":314,"./lo.js":314,"./lt":315,"./lt.js":315,"./lv":316,"./lv.js":316,"./me":317,"./me.js":317,"./mi":318,"./mi.js":318,"./mk":319,"./mk.js":319,"./ml":320,"./ml.js":320,"./mn":321,"./mn.js":321,"./mr":322,"./mr.js":322,"./ms":323,"./ms-my":324,"./ms-my.js":324,"./ms.js":323,"./mt":325,"./mt.js":325,"./my":326,"./my.js":326,"./nb":327,"./nb.js":327,"./ne":328,"./ne.js":328,"./nl":329,"./nl-be":330,"./nl-be.js":330,"./nl.js":329,"./nn":331,"./nn.js":331,"./pa-in":332,"./pa-in.js":332,"./pl":333,"./pl.js":333,"./pt":334,"./pt-br":335,"./pt-br.js":335,"./pt.js":334,"./ro":336,"./ro.js":336,"./ru":337,"./ru.js":337,"./sd":338,"./sd.js":338,"./se":339,"./se.js":339,"./si":340,"./si.js":340,"./sk":341,"./sk.js":341,"./sl":342,"./sl.js":342,"./sq":343,"./sq.js":343,"./sr":344,"./sr-cyrl":345,"./sr-cyrl.js":345,"./sr.js":344,"./ss":346,"./ss.js":346,"./sv":347,"./sv.js":347,"./sw":348,"./sw.js":348,"./ta":349,"./ta.js":349,"./te":350,"./te.js":350,"./tet":351,"./tet.js":351,"./tg":352,"./tg.js":352,"./th":353,"./th.js":353,"./tl-ph":354,"./tl-ph.js":354,"./tlh":355,"./tlh.js":355,"./tr":356,"./tr.js":356,"./tzl":357,"./tzl.js":357,"./tzm":358,"./tzm-latn":359,"./tzm-latn.js":359,"./tzm.js":358,"./ug-cn":360,"./ug-cn.js":360,"./uk":361,"./uk.js":361,"./ur":362,"./ur.js":362,"./uz":363,"./uz-latn":364,"./uz-latn.js":364,"./uz.js":363,"./vi":365,"./vi.js":365,"./x-pseudo":366,"./x-pseudo.js":366,"./yo":367,"./yo.js":367,"./zh-cn":368,"./zh-cn.js":368,"./zh-hk":369,"./zh-hk.js":369,"./zh-tw":370,"./zh-tw.js":370};function s(t){var e=a(t);return r(e)}function a(t){var e=n[t];if(!(e+1)){var r=new Error("Cannot find module '"+t+"'");throw r.code="MODULE_NOT_FOUND",r}return e}s.keys=function(){return Object.keys(n)},s.resolve=a,t.exports=s,s.id=390},396:function(t,e,r){"use strict";r.r(e);var n=r(3),s=r.n(n),a=r(4),i=r.n(a),o=r(384),c=r.n(o),u=r(24),l=r.n(u),p=r(232),f=r.n(p),d=r(44),h=r(29),v=r.n(h),j=r(30),y=r.n(j),m=r(234),b=function(){function t(e){v()(this,t),this.client=e,this.prefix="/soundclip"}return y()(t,[{key:"create",value:function(){var t=i()(s.a.mark(function t(e){var r,n,a,i,o;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.soundclip,n=e.beneficiaryID,a=e.onUploadProgress,i=void 0===a?function(){}:a,t.prev=1,(o=new FormData).append("soundclip",r,r.name),o.append("beneficiary_id",n),t.next=7,this.client.post(this.prefix,o,{headers:{"Content-Type":"multipart/form-data; boundary=".concat(o._boundary)},onUploadProgress:i,timeout:3e4});case 7:return t.abrupt("return",t.sent.data);case 10:return t.prev=10,t.t0=t.catch(1),console.error(m.a.getMessages(t.t0)),t.abrupt("return",t.t0);case 14:case"end":return t.stop()}},t,this,[[1,10]])}));return function(e){return t.apply(this,arguments)}}()},{key:"play",value:function(){var t=i()(s.a.mark(function t(e){return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.client.get(this.prefix+"/".concat(e,"/play"),{responseType:"arraybuffer"});case 3:return t.abrupt("return",t.sent.data);case 6:return t.prev=6,t.t0=t.catch(0),console.error(m.a.getMessages(t.t0)),t.abrupt("return",t.t0);case 10:case"end":return t.stop()}},t,this,[[0,6]])}));return function(e){return t.apply(this,arguments)}}()},{key:"getAll",value:function(){var t=i()(s.a.mark(function t(e){var r,n,a,i;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.beneficiaryID,n=void 0===r?null:r,a=e.load,i=void 0===a?[]:a,t.prev=1,t.next=4,this.client.get(this.prefix,{params:{beneficiary_id:n,load:i}});case 4:return t.abrupt("return",t.sent.data);case 7:return t.prev=7,t.t0=t.catch(1),console.error(m.a.getMessages(t.t0)),t.abrupt("return",t.t0);case 11:case"end":return t.stop()}},t,this,[[1,7]])}));return function(e){return t.apply(this,arguments)}}()}]),t}(),g=r(242),k=r(18),w=r.n(k),_=function(){function t(){v()(this,t)}return y()(t,null,[{key:"isEmpty",value:function(t){return!t||w()(t).length<=0}},{key:"isNotEmpty",value:function(t){return this.constructor.isEmpty(t)}}]),t}(),x=r(2),T=r.n(x),D=function(){function t(){v()(this,t)}return y()(t,null,[{key:"sleep",value:function(t){return new T.a(function(e){return setTimeout(e,t)})}}]),t}(),E=function(){function t(){v()(this,t),this.file={},this.instance={},this.initialized=!1}return y()(t,[{key:"initRecorder",value:function(){var t=i()(s.a.mark(function t(){var e=this;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.chunks=[],t.next=3,navigator.mediaDevices.getUserMedia({audio:!0});case 3:this.stream=t.sent,this.recorder=new MediaRecorder(this.stream),this.recorder.addEventListener("dataavailable",function(t){return e.chunks.push(t.data)}),this.initialized=!0;case 7:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"destroy",value:function(){this.stream&&this.stream.getTracks().forEach(function(t){return t.stop()})}},{key:"record",value:function(){var t=i()(s.a.mark(function t(){return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.initRecorder();case 2:this.recorder.start();case 3:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"stopRecord",value:function(){var t=this;return new T.a(function(e,r){t.initialized?(t.recorder.addEventListener("stop",function(){t.generateFromBuffer(t.chunks),e(t.instance)}),t.recorder.stop()):r(new Error("Not initialized"))})}},{key:"generateFromBuffer",value:function(t){this.file=new Blob(t,{type:"audio/mp4"});var e=URL.createObjectURL(this.file);return this.instance=new Audio(e),this.instance}}]),t}(),z=function(){function t(){v()(this,t)}return y()(t,null,[{key:"statusColour",value:function(e){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=r?"--text":"",s=r?"text--":"";switch(e){case t.STATUS_RECORDED:return"blue".concat(n," ").concat(s,"darken-2");case t.STATUS_SENT:return"amber".concat(n);case t.STATUS_DELIVERED:return"green".concat(n," ").concat(s,"lighten-1");case t.STATUS_INVALID:return"red".concat(n)}}},{key:"STATUS_RECORDED",get:function(){return 0}},{key:"STATUS_SENT",get:function(){return 1}},{key:"STATUS_DELIVERED",get:function(){return 2}},{key:"STATUS_INVALID",get:function(){return 3}}]),t}(),V={data:function(){return{soundclipHttp:{},beneficiaryHttp:{},audio:{},recording:!1,uploading:!1,uploaded:0}},computed:l()({},Object(d.b)({beneficiary:"beneficiary/currBeneficiary",soundclips:"beneficiary/soundclips"}),{showMic:function(){return!this.uploading&&!this.recording}}),methods:{statusColour:function(t){return z.statusColour(t.status,!0)},readDateTime:function(t){return f()(t.created_at).format("dddd, MMM Do YYYY, h:mm a")},uploadProgress:function(t){this.uploaded=c()(Math.round(100*t.loaded/t.total))},getBeneficiary:function(){var t=i()(s.a.mark(function t(){var e;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.beneficiaryHttp.show(this.$route.params.id);case 2:e=t.sent,this.$store.commit("beneficiary/setCurrBeneficiary",e);case 4:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),play:function(){var t=i()(s.a.mark(function t(e){var r;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.soundclipHttp.play(e.id);case 3:r=t.sent,this.audio.generateFromBuffer([r]).play(),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),console.error(t.t0.message);case 11:case"end":return t.stop()}},t,this,[[0,8]])}));return function(e){return t.apply(this,arguments)}}(),record:function(){var t=i()(s.a.mark(function t(){return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.audio.record();case 2:this.recording=!0;case 3:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),stopRecording:function(){var t=i()(s.a.mark(function t(){var e,r;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.audio.stopRecord();case 2:return e=t.sent,this.recording=!1,e.play(),this.uploading=!0,t.next=8,this.soundclipHttp.create({soundclip:this.audio.file,beneficiaryID:this.beneficiary.id,onUploadProgress:this.uploadProgress});case 8:return r=t.sent,this.$store.commit("beneficiary/addSoundclip",r),this.uploading=!1,t.next=13,D.sleep(1e4);case 13:this.audio.destroy();case 14:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},asyncData:function(){var t=i()(s.a.mark(function t(e){var r;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,new b(e.$axios).getAll({beneficiaryID:e.route.params.id});case 2:return r=t.sent,e.store.commit("beneficiary/setSoundclips",r),t.abrupt("return",{});case 5:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),fetch:function(t){t.store},beforeDestroy:function(){this.audio.destroy()},created:function(){this.soundclipHttp=new b(this.$axios),this.beneficiaryHttp=new g.a(this.$axios),this.audio=new E,_.isEmpty(this.beneficiary)&&this.getBeneficiary()}},S=r(31),A=r(89),U=r.n(A),R=r(83),C=r(236),I=r(371),L=r(76),O=r(392),M=r(81),N=r(84),B=r(82),H=r(78),P=r(79),$=r(80),F=r(230),Y=r(75),q=r(227),J=r(394),Z=r(399),G=Object(S.a)(V,function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("v-container",{attrs:{fluid:""}},[r("v-layout",{attrs:{row:"",wrap:""}},[r("v-flex",{attrs:{xs12:"",md10:"","offset-md1":""}},[r("v-card",[r("v-card-actions",[r("v-subheader",[r("v-icon",[t._v("music_note")]),t._v("Voicenotes for "+t._s(t.beneficiary.name))],1),t._v(" "),r("v-spacer"),t._v(" "),t.uploading?r("v-progress-circular",{attrs:{value:t.uploaded,color:"lime"}}):t._e(),t._v(" "),t.recording?r("v-btn",{attrs:{round:"",color:"primary"},on:{click:t.stopRecording}},[t._v("\r\n\t\t\t\t\t\tRecording...\r\n\t\t\t\t\t\t"),r("v-icon",{attrs:{right:""}},[t._v("stop")])],1):t._e(),t._v(" "),t.showMic?r("v-tooltip",{attrs:{bottom:""}},[r("v-btn",{attrs:{slot:"activator",fab:"",small:"",color:"primary"},on:{click:t.record},slot:"activator"},[r("v-icon",[t._v("mic")])],1),t._v(" "),r("span",[t._v("Record Voicenote")])],1):t._e()],1),t._v(" "),r("v-list",[t._l(t.soundclips,function(e,n){return[r("v-list-tile",{key:e.id},[r("v-list-tile-content",[r("v-list-tile-title",[t._v(t._s(t.readDateTime(e))+" - "),r("span",{class:t.statusColour(e)},[t._v(t._s(e.readStatus))])])],1),t._v(" "),r("v-list-tile-action",[r("v-tooltip",{attrs:{top:""}},[r("v-btn",{attrs:{slot:"activator",icon:"",ripple:""},on:{click:function(r){t.play(e)}},slot:"activator"},[r("v-icon",[t._v("hearing")])],1),t._v(" "),r("span",[t._v("Play")])],1)],1),t._v(" "),r("v-list-tile-action",[r("v-tooltip",{attrs:{top:""}},[r("v-btn",{attrs:{slot:"activator",icon:"",ripple:""},slot:"activator"},[r("v-icon",[t._v("send")])],1),t._v(" "),r("span",[t._v("Send")])],1)],1)],1),t._v(" "),n+1<t.soundclips.length?r("v-divider",{key:n}):t._e()]})],2)],1)],1)],1)],1)},[],!1,null,null,null);G.options.__file="soundclip.vue";e.default=G.exports;U()(G,{VBtn:R.a,VCard:C.a,VCardActions:I.a,VContainer:L.a,VDivider:O.a,VFlex:M.a,VIcon:N.a,VLayout:B.a,VList:H.a,VListTile:P.a,VListTileAction:$.a,VListTileContent:F.a,VListTileTitle:F.c,VProgressCircular:Y.a,VSpacer:q.a,VSubheader:J.a,VTooltip:Z.a})}}]);